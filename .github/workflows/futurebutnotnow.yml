name: FutureButNotNow Triple Bot Schedule

on:
  schedule:
    - cron: '0 13 * * *'   # 9:00 AM EST ‚Üí ProductBot
    - cron: '0 18 * * *'   # 2:00 PM EST ‚Üí TrendParasite 1
    - cron: '0 22 * * *'   # 6:00 PM EST ‚Üí TrendParasite 2
  workflow_dispatch:

jobs:
  runbots:
    runs-on: ubuntu-latest
    strategy:
      matrix:
        bot: [productbot, trendparasite1, trendparasite2]

    steps:
      - name: ‚è© Skip unselected bot
        if: >
          (matrix.bot == 'productbot' && github.event.schedule != '0 13 * * *') ||
          (matrix.bot == 'trendparasite1' && github.event.schedule != '0 18 * * *') ||
          (matrix.bot == 'trendparasite2' && github.event.schedule != '0 22 * * *')
        run: echo "Skipping this bot job for current time"; exit 0

      - name: üì• Checkout code
        uses: actions/checkout@v4

      - name: üêç Set up Python
        uses: actions/setup-python@v4
        with:
          python-version: '3.11'

      - name: ‚öôÔ∏è Install Dependencies
        run: |
          if [ "${{ matrix.bot }}" == "productbot" ]; then
            pip install -r productbot/requirements.txt
          else
            pip install -r trendparasite/requirements.txt
          fi

      - name: üöÄ Run Bot
        run: |
          if [ "${{ matrix.bot }}" == "productbot" ]; then
            python productbot/productbot_git.py
          elif [ "${{ matrix.bot }}" == "trendparasite1" ]; then
            python trendparasite/trend_sniffer.py
          elif [ "${{ matrix.bot }}" == "trendparasite2" ]; then
            python trendparasite/trend_sniffer.py
          fi

    env:
      OPENAI_API_KEY: ${{ secrets.OPENAI_API_KEY }}
      TWITTER_API_KEY: ${{ secrets.TWITTER_API_KEY }}
      TWITTER_API_SECRET: ${{ secrets.TWITTER_API_SECRET }}
      TWITTER_ACCESS_TOKEN: ${{ secrets.TWITTER_ACCESS_TOKEN }}
      TWITTER_ACCESS_SECRET: ${{ secrets.TWITTER_ACCESS_SECRET }}
      REDDIT_CLIENT_ID: ${{ secrets.REDDIT_CLIENT_ID }}
      REDDIT_CLIENT_SECRET: ${{ secrets.REDDIT_CLIENT_SECRET }}
      REDDIT_USERNAME: ${{ secrets.REDDIT_USERNAME }}
      REDDIT_PASSWORD: ${{ secrets.REDDIT_PASSWORD }}
      REDDIT_USER_AGENT: ${{ secrets.REDDIT_USER_AGENT }}
      SLACK_WEBHOOK_URL: ${{ secrets.SLACK_WEBHOOK_URL }}